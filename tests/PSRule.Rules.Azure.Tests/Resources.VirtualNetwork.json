[
    {
        "ResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A",
        "Id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A",
        "Location": "region",
        "ResourceName": "route-A",
        "Name": "route-A",
        "Properties": {
            "disableBgpRoutePropagation": false,
            "routes": [],
            "subnets": [
                {
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-A"
                },
                {
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-B"
                }
            ]
        },
        "ResourceGroupName": "test-rg",
        "Type": "Microsoft.Network/routeTables",
        "ResourceType": "Microsoft.Network/routeTables",
        "Tags": null,
        "SubscriptionId": "00000000-0000-0000-0000-000000000000"
    },
    {
        "ResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A",
        "Id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A",
        "Location": "region",
        "ResourceName": "vnet-A",
        "Name": "vnet-A",
        "Properties": {
            "addressSpace": {
                "addressPrefixes": [
                    "10.1.0.0/24"
                ]
            },
            "dhcpOptions": {
                "dnsServers": [
                    "10.1.0.36",
                    "168.63.129.16"
                ]
            },
            "subnets": [
                {
                    "name": "GatewaySubnet",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/GatewaySubnet",
                    "properties": {
                        "addressPrefix": "10.1.0.0/27",
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                },
                {
                    "name": "subnet-A",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-A",
                    "properties": {
                        "addressPrefix": "10.1.0.32/28",
                        "networkSecurityGroup": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A"
                        },
                        "routeTable": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A"
                        },
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                },
                {
                    "name": "subnet-B",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-B",
                    "properties": {
                        "addressPrefix": "10.1.0.48/28",
                        "networkSecurityGroup": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A"
                        },
                        "routeTable": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A"
                        },
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                },
                {
                    "name": "subnet-C",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-C",
                    "properties": {
                        "addressPrefix": "10.1.0.64/28",
                        "networkSecurityGroup": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A"
                        },
                        "routeTable": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A"
                        },
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                },
                {
                    "name": "subnet-D",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-D",
                    "properties": {
                        "addressPrefix": "10.1.0.80/28",
                        "networkSecurityGroup": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A"
                        },
                        "routeTable": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A"
                        },
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                }
            ],
            "virtualNetworkPeerings": [
                {
                    "name": "peer-B",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/virtualNetworkPeerings/peer-B",
                    "properties": {
                        "peeringState": "Connected",
                        "remoteVirtualNetwork": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-B"
                        },
                        "allowVirtualNetworkAccess": true,
                        "allowForwardedTraffic": false,
                        "allowGatewayTransit": false,
                        "useRemoteGateways": false,
                        "doNotVerifyRemoteGateways": false,
                        "remoteAddressSpace": {
                            "addressPrefixes": [
                                "10.2.0.0/24"
                            ]
                        },
                        "routeServiceVips": {}
                    },
                    "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings"
                }
            ],
            "enableDdosProtection": false,
            "enableVmProtection": false
        },
        "ResourceGroupName": "test-rg",
        "Type": "Microsoft.Network/virtualNetworks",
        "ResourceType": "Microsoft.Network/virtualNetworks",
        "Tags": null,
        "SubscriptionId": "00000000-0000-0000-0000-000000000000"
    },
    {
        "ResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-B",
        "Id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-B",
        "Location": "region",
        "ResourceName": "vnet-B",
        "Name": "vnet-B",
        "Properties": {
            "addressSpace": {
                "addressPrefixes": [
                    "10.2.0.0/24"
                ]
            },
            "dhcpOptions": {
                "dnsServers": [
                    "10.2.0.36"
                ]
            },
            "subnets": [
                {
                    "name": "GatewaySubnet",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/GatewaySubnet",
                    "properties": {
                        "addressPrefix": "10.2.0.0/27",
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                },
                {
                    "name": "subnet-A",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-A",
                    "properties": {
                        "addressPrefix": "10.2.0.32/28",
                        "networkSecurityGroup": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A"
                        },
                        "routeTable": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A"
                        },
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                },
                {
                    "name": "subnet-B",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-B",
                    "properties": {
                        "addressPrefix": "10.2.0.48/28",
                        "routeTable": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A"
                        },
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                },
                {
                    "name": "subnet-C",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-C",
                    "properties": {
                        "addressPrefix": "10.2.0.64/28",
                        "networkSecurityGroup": null,
                        "routeTable": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A"
                        },
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                },
                {
                    "name": "subnet-D",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-D",
                    "properties": {
                        "addressPrefix": "10.2.0.80/28",
                        "networkSecurityGroup": {},
                        "routeTable": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/routeTables/route-A"
                        },
                        "serviceEndpoints": [],
                        "delegations": []
                    },
                    "type": "Microsoft.Network/virtualNetworks/subnets"
                }
            ],
            "virtualNetworkPeerings": [
                {
                    "name": "peer-A",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/virtualNetworkPeerings/peer-A",
                    "properties": {
                        "peeringState": "Connected",
                        "remoteVirtualNetwork": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A"
                        },
                        "allowVirtualNetworkAc2cess": true,
                        "allowForwardedTraffic": false,
                        "allowGatewayTransit": false,
                        "useRemoteGateways": false,
                        "doNotVerifyRemoteGateways": false,
                        "remoteAddressSpace": {
                            "addressPrefixes": [
                                "10.1.0.0/24"
                            ]
                        },
                        "routeServiceVips": {}
                    },
                    "type": "Microsoft.Network/virtualNetworks/virtualNetworkPeerings"
                }
            ],
            "enableDdosProtection": false,
            "enableVmProtection": false
        },
        "ResourceGroupName": "test-rg",
        "Type": "Microsoft.Network/virtualNetworks",
        "ResourceType": "Microsoft.Network/virtualNetworks",
        "Tags": null,
        "SubscriptionId": "00000000-0000-0000-0000-000000000000"
    },
    {
        "ResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A",
        "Id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A",
        "Location": "region",
        "ResourceName": "nsg-A",
        "Name": "nsg-A",
        "Properties": {
            "securityRules": [
                {
                    "name": "allow-rdp-inbound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/securityRules/allow-rdp-inbound",
                    "type": "Microsoft.Network/networkSecurityGroups/securityRules",
                    "properties": {
                        "protocol": "Tcp",
                        "sourcePortRange": "*",
                        "destinationPortRange": "3389",
                        "destinationAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 400,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": [],
                        "sourceApplicationSecurityGroups": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationSecurityGroups/asg-A"
                            }
                        ]
                    }
                },
                {
                    "name": "allow-dc-to-dc-inbound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/securityRules/allow-dc-to-dc-inbound",
                    "type": "Microsoft.Network/networkSecurityGroups/securityRules",
                    "properties": {
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "destinationAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 300,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [
                            "10.1.0.32/28",
                            "10.2.0.32/28",
                            "10.3.0.32/28"
                        ],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "allow-dc-to-dc-outbound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/securityRules/allow-dc-to-dc-outbound",
                    "type": "Microsoft.Network/networkSecurityGroups/securityRules",
                    "properties": {
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 300,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": [
                            "10.1.0.32/28",
                            "10.2.0.32/28",
                            "10.3.0.32/28"
                        ]
                    }
                },
                {
                    "name": "deny-rdp-double-hop-outbound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/securityRules/deny-rdp-double-hop-outbound",
                    "type": "Microsoft.Network/networkSecurityGroups/securityRules",
                    "properties": {
                        "description": "Prevent outbound RDP.",
                        "protocol": "Tcp",
                        "sourcePortRange": "*",
                        "destinationPortRange": "3389",
                        "sourceAddressPrefix": "VirtualNetwork",
                        "destinationAddressPrefix": "*",
                        "access": "Deny",
                        "priority": 200,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                }
            ],
            "defaultSecurityRules": [
                {
                    "name": "AllowVnetInBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/defaultSecurityRules/AllowVnetInBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Allow inbound traffic from all VMs in VNET",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "VirtualNetwork",
                        "destinationAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 65000,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "AllowAzureLoadBalancerInBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/defaultSecurityRules/AllowAzureLoadBalancerInBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Allow inbound traffic from azure load balancer",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "AzureLoadBalancer",
                        "destinationAddressPrefix": "*",
                        "access": "Allow",
                        "priority": 65001,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "DenyAllInBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/defaultSecurityRules/DenyAllInBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Deny all inbound traffic",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefix": "*",
                        "access": "Deny",
                        "priority": 65500,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "AllowVnetOutBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/defaultSecurityRules/AllowVnetOutBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "VirtualNetwork",
                        "destinationAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 65000,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "AllowInternetOutBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/defaultSecurityRules/AllowInternetOutBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Allow outbound traffic from all VMs to Internet",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefix": "Internet",
                        "access": "Allow",
                        "priority": 65001,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "DenyAllOutBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-A/defaultSecurityRules/DenyAllOutBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Deny all outbound traffic",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefix": "*",
                        "access": "Deny",
                        "priority": 65500,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                }
            ],
            "subnets": [
                {
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-A"
                }
            ]
        },
        "ResourceGroupName": "test-rg",
        "Type": "Microsoft.Network/networkSecurityGroups",
        "ResourceType": "Microsoft.Network/networkSecurityGroups",
        "Tags": null,
        "SubscriptionId": "00000000-0000-0000-0000-000000000000"
    },
    {
        "ResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B",
        "Id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B",
        "Location": "region",
        "ResourceName": "nsg-B",
        "Name": "nsg-B",
        "Properties": {
            "securityRules": [
                {
                    "name": "allow-rdp-inbound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/securityRules/allow-rdp-inbound",
                    "type": "Microsoft.Network/networkSecurityGroups/securityRules",
                    "properties": {
                        "protocol": "Tcp",
                        "sourcePortRange": "*",
                        "destinationPortRange": "3389",
                        "destinationAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 400,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefix": "*",
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "allow-dc-to-dc-inbound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/securityRules/allow-dc-to-dc-inbound",
                    "type": "Microsoft.Network/networkSecurityGroups/securityRules",
                    "properties": {
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "destinationAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 300,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [
                            "10.1.0.32/28",
                            "10.2.0.32/28",
                            "10.3.0.32/28"
                        ],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "allow-dc-to-dc-outbound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/securityRules/allow-dc-to-dc-outbound",
                    "type": "Microsoft.Network/networkSecurityGroups/securityRules",
                    "properties": {
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 300,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": [
                            "10.1.0.32/28",
                            "10.2.0.32/28",
                            "10.3.0.32/28"
                        ]
                    }
                },
                {
                    "name": "deny-rdp-double-hop-outbound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/securityRules/deny-rdp-double-hop-outbound",
                    "type": "Microsoft.Network/networkSecurityGroups/securityRules",
                    "properties": {
                        "description": "Prevent outbound RDP.",
                        "protocol": "Tcp",
                        "sourcePortRange": "*",
                        "destinationPortRange": "3389",
                        "sourceAddressPrefix": "VirtualNetwork",
                        "destinationAddressPrefix": "*",
                        "access": "Deny",
                        "priority": 200,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                }
            ],
            "defaultSecurityRules": [
                {
                    "name": "AllowVnetInBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/defaultSecurityRules/AllowVnetInBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Allow inbound traffic from all VMs in VNET",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "VirtualNetwork",
                        "destinationAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 65000,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "AllowAzureLoadBalancerInBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/defaultSecurityRules/AllowAzureLoadBalancerInBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Allow inbound traffic from azure load balancer",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "AzureLoadBalancer",
                        "destinationAddressPrefix": "*",
                        "access": "Allow",
                        "priority": 65001,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "DenyAllInBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/defaultSecurityRules/DenyAllInBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Deny all inbound traffic",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefix": "*",
                        "access": "Deny",
                        "priority": 65500,
                        "direction": "Inbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "AllowVnetOutBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/defaultSecurityRules/AllowVnetOutBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Allow outbound traffic from all VMs to all VMs in VNET",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "VirtualNetwork",
                        "destinationAddressPrefix": "VirtualNetwork",
                        "access": "Allow",
                        "priority": 65000,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "AllowInternetOutBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/defaultSecurityRules/AllowInternetOutBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Allow outbound traffic from all VMs to Internet",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefix": "Internet",
                        "access": "Allow",
                        "priority": 65001,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                },
                {
                    "name": "DenyAllOutBound",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/networkSecurityGroups/nsg-B/defaultSecurityRules/DenyAllOutBound",
                    "type": "Microsoft.Network/networkSecurityGroups/defaultSecurityRules",
                    "properties": {
                        "description": "Deny all outbound traffic",
                        "protocol": "*",
                        "sourcePortRange": "*",
                        "destinationPortRange": "*",
                        "sourceAddressPrefix": "*",
                        "destinationAddressPrefix": "*",
                        "access": "Deny",
                        "priority": 65500,
                        "direction": "Outbound",
                        "sourcePortRanges": [],
                        "destinationPortRanges": [],
                        "sourceAddressPrefixes": [],
                        "destinationAddressPrefixes": []
                    }
                }
            ],
            "subnets": []
        },
        "ResourceGroupName": "test-rg",
        "Type": "Microsoft.Network/networkSecurityGroups",
        "ResourceType": "Microsoft.Network/networkSecurityGroups",
        "Tags": null,
        "SubscriptionId": "00000000-0000-0000-0000-000000000000"
    },
    {
        "ResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A",
        "Id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A",
        "Location": "region",
        "ResourceName": "appgw-A",
        "Name": "appgw-A",
        "Properties": {
            "sku": {
                "name": "WAF_Medium",
                "tier": "WAF",
                "capacity": 2
            },
            "gatewayIPConfigurations": [
                {
                    "name": "appGatewayIpConfig",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/gatewayIPConfigurations/appGatewayIpConfig",
                    "properties": {
                        "subnet": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-A"
                        }
                    },
                    "type": "Microsoft.Network/applicationGateways/gatewayIPConfigurations"
                }
            ],
            "sslCertificates": [],
            "authenticationCertificates": [],
            "frontendIPConfigurations": [
                {
                    "name": "appGatewayFrontendIP",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/frontendIPConfigurations/appGatewayFrontendIP",
                    "type": "Microsoft.Network/applicationGateways/frontendIPConfigurations",
                    "properties": {
                        "privateIPAllocationMethod": "Dynamic",
                        "publicIPAddress": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/publicIPAddresses/appgw-A-ip"
                        },
                        "httpListeners": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/httpListeners/appGatewayHttpListener"
                            }
                        ]
                    }
                }
            ],
            "frontendPorts": [
                {
                    "name": "appGatewayFrontendPort",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/frontendPorts/appGatewayFrontendPort",
                    "properties": {
                        "port": 80,
                        "httpListeners": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/httpListeners/appGatewayHttpListener"
                            }
                        ]
                    },
                    "type": "Microsoft.Network/applicationGateways/frontendPorts"
                }
            ],
            "backendAddressPools": [
                {
                    "name": "appGatewayBackendPool",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/backendAddressPools/appGatewayBackendPool",
                    "properties": {
                        "backendAddresses": [],
                        "requestRoutingRules": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/requestRoutingRules/rule1"
                            }
                        ]
                    },
                    "type": "Microsoft.Network/applicationGateways/backendAddressPools"
                }
            ],
            "backendHttpSettingsCollection": [
                {
                    "name": "appGatewayBackendHttpSettings",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/backendHttpSettingsCollection/appGatewayBackendHttpSettings",
                    "properties": {
                        "port": 80,
                        "protocol": "Http",
                        "cookieBasedAffinity": "Disabled",
                        "pickHostNameFromBackendAddress": false,
                        "requestTimeout": 30,
                        "requestRoutingRules": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/requestRoutingRules/rule1"
                            }
                        ]
                    },
                    "type": "Microsoft.Network/applicationGateways/backendHttpSettingsCollection"
                }
            ],
            "httpListeners": [
                {
                    "name": "appGatewayHttpListener",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/httpListeners/appGatewayHttpListener",
                    "properties": {
                        "frontendIPConfiguration": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/frontendIPConfigurations/appGatewayFrontendIP"
                        },
                        "frontendPort": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/frontendPorts/appGatewayFrontendPort"
                        },
                        "protocol": "Http",
                        "requireServerNameIndication": false,
                        "requestRoutingRules": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/requestRoutingRules/rule1"
                            }
                        ]
                    },
                    "type": "Microsoft.Network/applicationGateways/httpListeners"
                }
            ],
            "urlPathMaps": [],
            "requestRoutingRules": [
                {
                    "name": "rule1",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/requestRoutingRules/rule1",
                    "properties": {
                        "ruleType": "Basic",
                        "httpListener": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/httpListeners/appGatewayHttpListener"
                        },
                        "backendAddressPool": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/backendAddressPools/appGatewayBackendPool"
                        },
                        "backendHttpSettings": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-A/backendHttpSettingsCollection/appGatewayBackendHttpSettings"
                        }
                    },
                    "type": "Microsoft.Network/applicationGateways/requestRoutingRules"
                }
            ],
            "probes": [],
            "rewriteRuleSets": [],
            "redirectConfigurations": [],
            "webApplicationFirewallConfiguration": {
                "enabled": true,
                "firewallMode": "Prevention",
                "ruleSetType": "OWASP",
                "ruleSetVersion": "3.0",
                "disabledRuleGroups": [],
                "requestBodyCheck": true,
                "maxRequestBodySizeInKb": 128,
                "fileUploadLimitInMb": 100
            },
            "sslPolicy": {
                "minProtocolVersion": "TLSv1_2"
            },
            "enableHttp2": true
        },
        "ResourceGroupName": "test-rg",
        "Type": "Microsoft.Network/applicationGateways",
        "ResourceType": "Microsoft.Network/applicationGateways",
        "Tags": null,
        "SubscriptionId": "00000000-0000-0000-0000-000000000000"
    },
    {
        "ResourceId": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B",
        "Id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B",
        "Location": "region",
        "ResourceName": "appgw-B",
        "Name": "appgw-B",
        "Properties": {
            "sku": {
                "name": "Standard_Small",
                "tier": "Standard",
                "capacity": 1
            },
            "gatewayIPConfigurations": [
                {
                    "name": "appGatewayIpConfig",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/gatewayIPConfigurations/appGatewayIpConfig",
                    "properties": {
                        "subnet": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/virtualNetworks/vnet-A/subnets/subnet-A"
                        }
                    },
                    "type": "Microsoft.Network/applicationGateways/gatewayIPConfigurations"
                }
            ],
            "sslCertificates": [],
            "authenticationCertificates": [],
            "frontendIPConfigurations": [
                {
                    "name": "appGatewayFrontendIP",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/frontendIPConfigurations/appGatewayFrontendIP",
                    "type": "Microsoft.Network/applicationGateways/frontendIPConfigurations",
                    "properties": {
                        "privateIPAllocationMethod": "Dynamic",
                        "publicIPAddress": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/publicIPAddresses/appgw-B-ip"
                        },
                        "httpListeners": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/httpListeners/appGatewayHttpListener"
                            }
                        ]
                    }
                }
            ],
            "frontendPorts": [
                {
                    "name": "appGatewayFrontendPort",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/frontendPorts/appGatewayFrontendPort",
                    "properties": {
                        "port": 80,
                        "httpListeners": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/httpListeners/appGatewayHttpListener"
                            }
                        ]
                    },
                    "type": "Microsoft.Network/applicationGateways/frontendPorts"
                }
            ],
            "backendAddressPools": [
                {
                    "name": "appGatewayBackendPool",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/backendAddressPools/appGatewayBackendPool",
                    "properties": {
                        "backendAddresses": [],
                        "requestRoutingRules": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/requestRoutingRules/rule1"
                            }
                        ]
                    },
                    "type": "Microsoft.Network/applicationGateways/backendAddressPools"
                }
            ],
            "backendHttpSettingsCollection": [
                {
                    "name": "appGatewayBackendHttpSettings",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/backendHttpSettingsCollection/appGatewayBackendHttpSettings",
                    "properties": {
                        "port": 80,
                        "protocol": "Http",
                        "cookieBasedAffinity": "Disabled",
                        "pickHostNameFromBackendAddress": false,
                        "requestTimeout": 30,
                        "requestRoutingRules": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/requestRoutingRules/rule1"
                            }
                        ]
                    },
                    "type": "Microsoft.Network/applicationGateways/backendHttpSettingsCollection"
                }
            ],
            "httpListeners": [
                {
                    "name": "appGatewayHttpListener",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/httpListeners/appGatewayHttpListener",
                    "properties": {
                        "frontendIPConfiguration": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/frontendIPConfigurations/appGatewayFrontendIP"
                        },
                        "frontendPort": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/frontendPorts/appGatewayFrontendPort"
                        },
                        "protocol": "Http",
                        "requireServerNameIndication": false,
                        "requestRoutingRules": [
                            {
                                "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/requestRoutingRules/rule1"
                            }
                        ]
                    },
                    "type": "Microsoft.Network/applicationGateways/httpListeners"
                }
            ],
            "urlPathMaps": [],
            "requestRoutingRules": [
                {
                    "name": "rule1",
                    "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/requestRoutingRules/rule1",
                    "properties": {
                        "ruleType": "Basic",
                        "httpListener": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/httpListeners/appGatewayHttpListener"
                        },
                        "backendAddressPool": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/backendAddressPools/appGatewayBackendPool"
                        },
                        "backendHttpSettings": {
                            "id": "/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/test-rg/providers/Microsoft.Network/applicationGateways/appgw-B/backendHttpSettingsCollection/appGatewayBackendHttpSettings"
                        }
                    },
                    "type": "Microsoft.Network/applicationGateways/requestRoutingRules"
                }
            ],
            "probes": [],
            "rewriteRuleSets": [],
            "redirectConfigurations": [],
            "webApplicationFirewallConfiguration": {
                "enabled": true,
                "firewallMode": "Detection",
                "ruleSetType": "OWASP",
                "ruleSetVersion": "3.0",
                "disabledRuleGroups": [],
                "requestBodyCheck": true,
                "maxRequestBodySizeInKb": 128,
                "fileUploadLimitInMb": 100
            },
            "enableHttp2": true
        },
        "ResourceGroupName": "test-rg",
        "Type": "Microsoft.Network/applicationGateways",
        "ResourceType": "Microsoft.Network/applicationGateways",
        "Tags": null,
        "SubscriptionId": "00000000-0000-0000-0000-000000000000"
    }
]
